import{a as U,b as K,f as D}from"../chunks/BIsglS6e.js";import"../chunks/BWu6i66n.js";import{a5 as Y,R as A,d as a,a4 as y,a9 as X,at as it,au as ot,ab as tt,a2 as j,a3 as M,aa as S,w as L,ac as st,p as ct}from"../chunks/DQh97eD0.js";import{e as Z,i as H}from"../chunks/yUTlCcli.js";import{i as et}from"../chunks/bOeLg15Y.js";import{p as k}from"../chunks/DIpfiEvs.js";import{s as T,r as ut}from"../chunks/CVMgCsAL.js";import{C as ft}from"../chunks/QWelmNQT.js";import{e as Q,s as $}from"../chunks/c_-inOZy.js";import{i as lt}from"../chunks/YrRgrY_w.js";import{b as vt,F as dt}from"../chunks/C5A3O8JK.js";var ht=K("<rect></rect>"),mt=K('<svg class="d-b svelte-1oxmzpg"></svg>');function pt(r,o){let u=k(o,"seed",8),f=k(o,"width",8,1e3),c=k(o,"height",8,1e3);function p(v){return function(){let t=v+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}const g=p(u());let h=[];const _=32;function C(v){const{x:t,y:n,w:l,h:d}=v;if(l<_*2&&d<_*2){h.push(v);return}const R=g()>.5;if(R&&d>=_*2){const i=(.3+g()*.4)*d,F={x:t,y:n,w:l,h:i},b={x:t,y:n+i,w:l,h:d-i};C(F),C(b)}else if(!R&&l>=_*2){const i=(.3+g()*.4)*l,F={x:t,y:n,w:i,h:d},b={x:t+i,y:n,w:l-i,h:d};C(F),C(b)}else h.push(v)}C({x:0,y:0,w:f(),h:c()});const w=["#FBB","#FDA","#FFB","#DFC","#AFF","#ACF","#CBF","#FCF","none"],e=()=>w[Math.floor(g()*w.length)];var s=mt();Z(s,5,()=>h,H,(v,t)=>{var n=ht();Y(l=>{T(n,"x",(a(t),A(()=>a(t).x))),T(n,"y",(a(t),A(()=>a(t).y))),T(n,"width",(a(t),A(()=>a(t).w))),T(n,"height",(a(t),A(()=>a(t).h))),T(n,"fill",l)},[()=>A(e)]),U(v,n)}),y(s),Y(()=>{T(s,"width",f()),T(s,"height",c()),T(s,"viewBox",`0 0 ${f()??""} ${c()??""}`)}),U(r,s)}var W={},O={},q=34,N=10,z=13;function rt(r){return new Function("d","return {"+r.map(function(o,u){return JSON.stringify(o)+": d["+u+'] || ""'}).join(",")+"}")}function gt(r,o){var u=rt(r);return function(f,c){return o(u(f),c,r)}}function G(r){var o=Object.create(null),u=[];return r.forEach(function(f){for(var c in f)c in o||u.push(o[c]=c)}),u}function m(r,o){var u=r+"",f=u.length;return f<o?new Array(o-f+1).join(0)+u:u}function _t(r){return r<0?"-"+m(-r,6):r>9999?"+"+m(r,6):m(r,4)}function Ct(r){var o=r.getUTCHours(),u=r.getUTCMinutes(),f=r.getUTCSeconds(),c=r.getUTCMilliseconds();return isNaN(r)?"Invalid Date":_t(r.getUTCFullYear())+"-"+m(r.getUTCMonth()+1,2)+"-"+m(r.getUTCDate(),2)+(c?"T"+m(o,2)+":"+m(u,2)+":"+m(f,2)+"."+m(c,3)+"Z":f?"T"+m(o,2)+":"+m(u,2)+":"+m(f,2)+"Z":u||o?"T"+m(o,2)+":"+m(u,2)+"Z":"")}function wt(r){var o=new RegExp('["'+r+`
\r]`),u=r.charCodeAt(0);function f(e,s){var v,t,n=c(e,function(l,d){if(v)return v(l,d-1);t=l,v=s?gt(l,s):rt(l)});return n.columns=t||[],n}function c(e,s){var v=[],t=e.length,n=0,l=0,d,R=t<=0,i=!1;e.charCodeAt(t-1)===N&&--t,e.charCodeAt(t-1)===z&&--t;function F(){if(R)return O;if(i)return i=!1,W;var B,x=n,E;if(e.charCodeAt(x)===q){for(;n++<t&&e.charCodeAt(n)!==q||e.charCodeAt(++n)===q;);return(B=n)>=t?R=!0:(E=e.charCodeAt(n++))===N?i=!0:E===z&&(i=!0,e.charCodeAt(n)===N&&++n),e.slice(x+1,B-1).replace(/""/g,'"')}for(;n<t;){if((E=e.charCodeAt(B=n++))===N)i=!0;else if(E===z)i=!0,e.charCodeAt(n)===N&&++n;else if(E!==u)continue;return e.slice(x,B)}return R=!0,e.slice(x,t)}for(;(d=F())!==O;){for(var b=[];d!==W&&d!==O;)b.push(d),d=F();s&&(b=s(b,l++))==null||v.push(b)}return v}function p(e,s){return e.map(function(v){return s.map(function(t){return w(v[t])}).join(r)})}function g(e,s){return s==null&&(s=G(e)),[s.map(w).join(r)].concat(p(e,s)).join(`
`)}function h(e,s){return s==null&&(s=G(e)),p(e,s).join(`
`)}function _(e){return e.map(C).join(`
`)}function C(e){return e.map(w).join(r)}function w(e){return e==null?"":e instanceof Date?Ct(e):o.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:f,parseRows:c,format:g,formatBody:h,formatRows:_,formatRow:C,formatValue:w}}var bt=wt(","),yt=bt.parse,Ft=D('<a class="row d-g al-ct svelte-153i7me"><div> </div> <div> </div> <div><i> </i></div> <div><kbd> </kbd></div></a>'),At=D('<div class="wrap flow-y-s svelte-153i7me"><div class="grid d-g svelte-153i7me"><div class="head d-g al-ct p-stx fw7 svelte-153i7me"><div>Year</div> <div>Title</div> <div>Author</div> <div>ISBN</div></div> <!></div></div>'),jt=D('<section class="search rx10 p5 m20 sw-100 svelte-153i7me"><input type="text" class="p10 sw-100 d-b svelte-153i7me" placeholder="Search" id="global"/> <!></section>');function Tt(r,o){X(o,!1);const u=L(),f=["author","name","isbn","year"];let c=L(""),p=L([]),g=[],h;async function _(){if(h)return;const t=await fetch("/search.csv").then(l=>l.text()),n=f.join(",")+`
`;g=yt(n+t),h=new dt(g,{keys:f,threshold:.4,ignoreLocation:!0,minMatchCharLength:2})}function C(){const t=a(c).trim();if(!h||t.length<=2){S(p,[]);return}S(p,(h?.search(t)||[]).map(n=>n.item))}it(()=>(a(c),a(p)),()=>{S(u,a(c).trim().length>2&&a(p).length>0)}),ot(),et();var w=jt(),e=j(w);ut(e);var s=M(e,2);{var v=t=>{var n=At(),l=j(n),d=M(j(l),2);Z(d,1,()=>a(p),H,(R,i)=>{var F=Ft(),b=j(F),B=j(b,!0);y(b);var x=M(b,2),E=j(x,!0);y(x);var I=M(x,2),P=j(I),nt=j(P,!0);y(P),y(I);var V=M(I,2),J=j(V),at=j(J,!0);y(J),y(V),y(F),Y(()=>{T(F,"href",`/${a(i),A(()=>a(i).year)??""}#${a(i),A(()=>a(i).isbn)??""}`),$(B,(a(i),A(()=>a(i).year))),$(E,(a(i),A(()=>a(i).name))),$(nt,(a(i),A(()=>a(i).author))),$(at,(a(i),A(()=>a(i).isbn)))}),U(R,F)}),y(l),y(n),U(t,n)};lt(s,t=>{a(u)&&t(v)})}y(w),vt(e,()=>a(c),t=>S(c,t)),Q("focus",e,_),Q("input",e,C),U(r,w),tt()}var Rt=D('<!> <section class="f fw j-ar"></section>',1);function Lt(r,o){X(o,!1);const f=k(o,"data",24,()=>[])().files.map(h=>h.replace(".csv",""));et();var c=Rt(),p=st(c);Tt(p,{});var g=M(p,2);Z(g,5,()=>f,H,(h,_)=>{ft(h,{get url(){return`/${a(_)??""}`},get name(){return a(_)},children:(C,w)=>{{let e=ct(()=>a(_)-2021);pt(C,{get seed(){return a(e)},height:150,width:300})}},$$slots:{default:!0}})}),y(g),U(r,c),tt()}export{Lt as component};
