import{S as K,i as X,s as Z,y as z,a as I,k as w,z as x,c as V,l as b,m as E,h as p,n as M,p as y,A as tt,b as g,E as L,P as A,Q as et,g as it,d as lt,B as st,o as ft,q as H,r as J,N as q,R as nt,T as rt,e as Y,u as at}from"../chunks/index.33b5794c.js";import{M as ot}from"../chunks/meta.168d2e6e.js";class ht{constructor(t,e,i,s=0){this.arcs=[],this.tint=0,this.x=t,this.y=e,this.key=i,this.id=i,this.val=s,this.cap=this.val>0?1:2}reset(){this.arcs=[],this.id=this.key,this.val===0&&(this.tint=0),this.cap=this.val>0?1:2}add(t,e=!0){if(this.arcs.includes(t)?e&&this.del(t):this.arcs.push(t),this.arcs.length>this.cap){let i=this.arcs.splice(0,1)[0];N(this,i)}}del(t){if(this.arcs.includes(t)){let e=this.arcs.indexOf(t);this.arcs.splice(e,1),this.arcs.length===0&&this.val===0&&(this.tint=0)}}dist(t){return Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}tag(t,e,i){this.id=i,this.tint===0&&(this.tint=t.tint);for(let s of this.arcs)s!==t&&s!==e&&s.tag(t,this,i)}nuke(){for(;this.arcs.length>0;){let t=this.arcs[0];N(t,this),t.nuke()}}rand(t,e){let i=[[0,-1],[-1,0],[1,0],[0,1]];for(let s=0;s<1;s++){let o=i[Math.floor(Math.random()*i.length)],f=this.x+o[0],r=this.y+o[1];if(f>=0&&f<e&&r>=0&&r<e){let h=t[f+r*e];F(h,this,!1)}}}grow(t,e){let i=[[0,-1],[-1,0],[1,0],[0,1]];for(let s of i){let o=this.x+s[0],f=this.y+s[1];if(o>=0&&o<e&&f>=0&&f<e){let r=t[o+f*e];if(r&&r.arcs.length===0){F(r,this,!1);return}}}if(this.arcs.length===1){let s=this.arcs[0],o=this.x+(this.x-s.x),f=this.y+(this.y-s.y);if(o>=0&&o<e&&f>=0&&f<e){let r=t[o+f*e];(r.arcs.length<=1||s.arcs.length===1)&&F(r,this,!1)}}}test(){let t=!1;if(this.arcs.length===2){let e=this.arcs[0],i=this.arcs[1];if(e.arcs.length===2){let s=e.arcs[0];s===this&&(s=e.arcs[1]),i.dist(s)===1&&(N(e,this),t=!0)}if(i.arcs.length===2){let s=i.arcs[0];s===this&&(s=i.arcs[1]),e.dist(s)===1&&(N(i,this),t=!0)}}return t}trim(t,e){let i=!1,s=0,o=[[0,-1],[-1,0],[1,0],[0,1]];for(let f of o){let r=this.x+f[0],h=this.y+f[1],v=this.x+f[0]*2,k=this.y+f[1]*2,u=r>=0&&r<e&&h>=0&&h<e?t[r+h*e]:void 0,c=v>=0&&v<e&&k>=0&&k<e?t[v+k*e]:void 0;u&&(u.id===this.id?(s++,u.arcs.length===1&&this.arcs.length===1&&(s=3)):c&&c.id===this.id&&this.arcs.length===1&&(s=3))}if(s>=3){let f=this.arcs[0];N(f,this),i=!0}return i}}function F(l,t,e=!0){if(l.id===t.id){N(l,t);return}l.tint!==t.tint&&l.tint!==0&&t.tint!==0||(l.add(t,e),t.add(l,e),l.tag(t,l,t.id),t.tag(l,t,l.id))}function N(l,t){l.del(t),t.del(l),l.tag(l,l,l.key),t.tag(t,t,t.key)}function ut(l){let t=l.length,e;for(;t!=0;)e=Math.floor(Math.random()*t),t--,[l[t],l[e]]=[l[e],l[t]];return l}function ct(l){let t=[],e=[];for(let f=0;f<l;f++)for(let r=0;r<l;r++)t.push(new ht(r,f,r+f*l));t.forEach(f=>f.rand(t,l));let i=!0;for(;i;){i=!1;let f=[...t];ut(f),f.forEach(r=>r.grow(t,l)),f.forEach(r=>{i|=r.test()}),f.forEach(r=>{i|=r.trim(t,l)})}let s=t.filter(f=>f.arcs.length===1),o=1;for(;s.length>0;){let f=s.pop(),r=s.filter(h=>h.id===f.id)[0];if(f&&r){let h=o/11.3%1;f.val=o,r.val=o,f.tint=h,r.tint=h,f.pair=r,r.pair=f,o++,e.push([f,r]),s=s.filter(v=>v.id!==f.id)}}return t.map(f=>f.reset()),{grid:t,sets:e}}function R(l){return l===0?"transparent":`hsl(${Math.floor(l*360)}, 70%, 60%)`}function B(l,t,e){const i=l.slice();i[15]=t[e];const s=R(i[15].tint);return i[16]=s,i}function C(l){let t,e;return{c(){t=w("div"),e=H("You win!"),this.h()},l(i){t=b(i,"DIV",{class:!0,style:!0});var s=E(t);e=J(s,"You win!"),s.forEach(p),this.h()},h(){M(t,"class","f j-ct al-ct p10 fw7"),y(t,"font-size","4em")},m(i,s){g(i,t,s),L(t,e)},d(i){i&&p(t)}}}function G(l){let t,e,i=D(l[15],0,-1),s,o=D(l[15],0,1),f,r=D(l[15],-1,0),h,v=D(l[15],1,0),k,u=i&&O(l),c=o&&Q(l),d=r&&T(l),a=v&&U(l);return{c(){t=w("div"),e=I(),u&&u.c(),s=I(),c&&c.c(),f=I(),d&&d.c(),h=I(),a&&a.c(),k=Y(),this.h()},l(n){t=b(n,"DIV",{class:!0,style:!0}),E(t).forEach(p),e=V(n),u&&u.l(n),s=V(n),c&&c.l(n),f=V(n),d&&d.l(n),h=V(n),a&&a.l(n),k=Y(),this.h()},h(){M(t,"class","pipe svelte-kyuois"),y(t,"background",l[16])},m(n,m){g(n,t,m),g(n,e,m),u&&u.m(n,m),g(n,s,m),c&&c.m(n,m),g(n,f,m),d&&d.m(n,m),g(n,h,m),a&&a.m(n,m),g(n,k,m)},p(n,m){m&2&&y(t,"background",n[16]),m&2&&(i=D(n[15],0,-1)),i?u?u.p(n,m):(u=O(n),u.c(),u.m(s.parentNode,s)):u&&(u.d(1),u=null),m&2&&(o=D(n[15],0,1)),o?c?c.p(n,m):(c=Q(n),c.c(),c.m(f.parentNode,f)):c&&(c.d(1),c=null),m&2&&(r=D(n[15],-1,0)),r?d?d.p(n,m):(d=T(n),d.c(),d.m(h.parentNode,h)):d&&(d.d(1),d=null),m&2&&(v=D(n[15],1,0)),v?a?a.p(n,m):(a=U(n),a.c(),a.m(k.parentNode,k)):a&&(a.d(1),a=null)},d(n){n&&p(t),n&&p(e),u&&u.d(n),n&&p(s),c&&c.d(n),n&&p(f),d&&d.d(n),n&&p(h),a&&a.d(n),n&&p(k)}}}function O(l){let t;return{c(){t=w("div"),this.h()},l(e){t=b(e,"DIV",{class:!0,style:!0}),E(t).forEach(p),this.h()},h(){M(t,"class","pipe n svelte-kyuois"),y(t,"background",l[16])},m(e,i){g(e,t,i)},p(e,i){i&2&&y(t,"background",e[16])},d(e){e&&p(t)}}}function Q(l){let t;return{c(){t=w("div"),this.h()},l(e){t=b(e,"DIV",{class:!0,style:!0}),E(t).forEach(p),this.h()},h(){M(t,"class","pipe s svelte-kyuois"),y(t,"background",l[16])},m(e,i){g(e,t,i)},p(e,i){i&2&&y(t,"background",e[16])},d(e){e&&p(t)}}}function T(l){let t;return{c(){t=w("div"),this.h()},l(e){t=b(e,"DIV",{class:!0,style:!0}),E(t).forEach(p),this.h()},h(){M(t,"class","pipe w svelte-kyuois"),y(t,"background",l[16])},m(e,i){g(e,t,i)},p(e,i){i&2&&y(t,"background",e[16])},d(e){e&&p(t)}}}function U(l){let t;return{c(){t=w("div"),this.h()},l(e){t=b(e,"DIV",{class:!0,style:!0}),E(t).forEach(p),this.h()},h(){M(t,"class","pipe e svelte-kyuois"),y(t,"background",l[16])},m(e,i){g(e,t,i)},p(e,i){i&2&&y(t,"background",e[16])},d(e){e&&p(t)}}}function W(l){let t,e=l[15].val+"",i;return{c(){t=w("div"),i=H(e),this.h()},l(s){t=b(s,"DIV",{class:!0,style:!0});var o=E(t);i=J(o,e),o.forEach(p),this.h()},h(){M(t,"class","dot f al-ct j-ct fw7 svelte-kyuois"),y(t,"color",R(l[15].tint))},m(s,o){g(s,t,o),L(t,i)},p(s,o){o&2&&e!==(e=s[15].val+"")&&at(i,e),o&2&&y(t,"color",R(s[15].tint))},d(s){s&&p(t)}}}function $(l,t){let e,i,s,o,f,r=t[15].tint&&G(t),h=t[15].val>0&&W(t);function v(){return t[7](t[15])}function k(){return t[8](t[15])}function u(){return t[9](t[15])}return{key:l,first:null,c(){e=w("div"),r&&r.c(),i=I(),h&&h.c(),s=I(),this.h()},l(c){e=b(c,"DIV",{class:!0});var d=E(e);r&&r.l(d),i=V(d),h&&h.l(d),s=V(d),d.forEach(p),this.h()},h(){M(e,"class","tile f al-ct j-ct ptr p-rel rx50 svelte-kyuois"),q(e,"end",t[15].val>0),q(e,"pressed",t[15].tint),this.first=e},m(c,d){g(c,e,d),r&&r.m(e,null),L(e,i),h&&h.m(e,null),L(e,s),o||(f=[A(e,"mousedown",v),A(e,"mouseenter",k),A(e,"dblclick",u)],o=!0)},p(c,d){t=c,t[15].tint?r?r.p(t,d):(r=G(t),r.c(),r.m(e,i)):r&&(r.d(1),r=null),t[15].val>0?h?h.p(t,d):(h=W(t),h.c(),h.m(e,s)):h&&(h.d(1),h=null),d&2&&q(e,"end",t[15].val>0),d&2&&q(e,"pressed",t[15].tint)},d(c){c&&p(e),r&&r.d(),h&&h.d(),o=!1,nt(f)}}}function dt(l){let t,e,i,s,o,f=[],r=new Map,h,v,k;t=new ot({props:{description:"Flow based on numberlink",name:"Flow Game"}});let u=l[2]&&C(),c=l[1];const d=a=>a[15].key;for(let a=0;a<c.length;a+=1){let n=B(l,c,a),m=d(n);r.set(m,f[a]=$(m,n))}return{c(){z(t.$$.fragment),e=I(),i=w("div"),u&&u.c(),s=I(),o=w("div");for(let a=0;a<f.length;a+=1)f[a].c();this.h()},l(a){x(t.$$.fragment,a),e=V(a),i=b(a,"DIV",{class:!0});var n=E(i);u&&u.l(n),s=V(n),o=b(n,"DIV",{class:!0,style:!0});var m=E(o);for(let j=0;j<f.length;j+=1)f[j].l(m);m.forEach(p),n.forEach(p),this.h()},h(){M(o,"class","grid p0 mx-a svelte-kyuois"),y(o,"--dim",l[0]),y(o,"--wall",mt+"px"),M(i,"class","box h-100 w-100 f-col j-ct p0 svelte-kyuois")},m(a,n){tt(t,a,n),g(a,e,n),g(a,i,n),u&&u.m(i,null),L(i,s),L(i,o);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(o,null);h=!0,v||(k=A(o,"mouseleave",l[5]),v=!0)},p(a,[n]){a[2]?u||(u=C(),u.c(),u.m(i,s)):u&&(u.d(1),u=null),n&90&&(c=a[1],f=et(f,n,d,1,a,c,r,o,rt,$,null,B)),(!h||n&1)&&y(o,"--dim",a[0])},i(a){h||(it(t.$$.fragment,a),h=!0)},o(a){lt(t.$$.fragment,a),h=!1},d(a){st(t,a),a&&p(e),a&&p(i),u&&u.d();for(let n=0;n<f.length;n+=1)f[n].d();v=!1,k()}}}let mt=600;function D(l,t,e){return l.arcs.some(i=>i.x===l.x+t&&i.y===l.y+e)}function _t(l,t,e){let i=12,s=[],o=[],f=!1,r=null,h=!1;function v(){e(2,h=!1);let _=ct(i);e(1,s=_.grid),o=_.sets}function k(_){h||_.tint!==0&&(r=_,f=!0)}function u(_){if(!f||!r||h)return;Math.abs(_.x-r.x)+Math.abs(_.y-r.y)===1&&(F(_,r),r=_,e(1,s),a())}function c(){f=!1,r=null}function d(_){_&&(_.nuke(),e(1,s),a())}function a(){let _=!0;s.filter(S=>S.arcs.length===0).length>0&&(_=!1);for(let S of o)S[0].id!==S[1].id&&(_=!1);e(2,h=_)}ft(()=>{let _=new URLSearchParams(window.location.search),P=Number(_.get("scale")??12);return P>=5&&P<=15&&e(0,i=P),v(),window.addEventListener("mouseup",c),()=>window.removeEventListener("mouseup",c)});const n=_=>k(_),m=_=>u(_),j=_=>d(_);return e(0,i=12),v(),[i,s,h,k,u,c,d,n,m,j]}class kt extends K{constructor(t){super(),X(this,t,_t,dt,Z,{})}}export{kt as component};
